<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Court AI Legal Assistant</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
    body { font-family: 'Inter', sans-serif; background: #f0f4f8; margin: 0; padding: 0; }
    header { background: #1e293b; color: white; padding: 2rem; text-align: center; }
    h1 { margin: 0; font-size: 2.2rem; }
    .container { max-width: 1000px; margin: 2rem auto; padding: 1rem; }
    .card { background: white; border-radius: 12px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 8px 20px rgba(0,0,0,0.08); transition: transform 0.3s; }
    .card:hover { transform: translateY(-5px); }
    textarea { width: 100%; height: 140px; padding: 1rem; border-radius: 8px; border: 1px solid #ccc; font-size: 1rem; margin-top: 1rem; }
    select, button { margin-top: 1rem; padding: 0.8rem 1.2rem; font-size: 1rem; border-radius: 8px; border: none; cursor: pointer; }
    button { background: #2563eb; color: white; transition: background 0.3s; }
    button:hover { background: #1d4ed8; }
    .output { margin-top: 1.5rem; padding: 1rem; background: #f1f5f9; border-radius: 10px; }
    .badge { display: inline-block; padding: 0.3rem 0.6rem; border-radius: 5px; font-weight: 600; margin-right: 0.5rem; font-size: 0.85rem; }
    .plaintiff { background: #3b82f6; color: white; }
    .defendant { background: #ef4444; color: white; }
    .leaning { background: #facc15; color: black; }
    .weak-point { background: #a1a1aa; color: white; }
    .collapsible { cursor: pointer; padding: 1rem; border-radius: 8px; background: #e2e8f0; margin-bottom: 1rem; }
    .content { display: none; padding: 1rem 1rem 0 1rem; background: #f8fafc; border-radius: 0 0 8px 8px; animation: fadeIn 0.5s ease forwards; }
    @keyframes fadeIn { from {opacity: 0;} to {opacity:1;} }
    .laws-section h3 { margin-top: 1rem; color: #1e293b; }
    .laws-section a { text-decoration: none; color: #2563eb; display: block; margin-bottom: 0.3rem; }
    .chatbot-icon { position: fixed; bottom: 2rem; right: 2rem; width: 60px; height: 60px; border-radius: 50%; background: #2563eb; color: white; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 1000; }
    .chatbot-window { position: fixed; bottom: 5rem; right: 2rem; width: 350px; max-height: 500px; background: white; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.2); display: none; flex-direction: column; overflow: hidden; z-index: 1000; }
    .chatbot-header { background: #2563eb; color: white; padding: 1rem; font-weight: 600; }
    .chatbot-messages { padding: 1rem; flex-grow: 1; overflow-y: auto; background: #f1f5f9; }
    .chatbot-input { display: flex; border-top: 1px solid #ccc; }
    .chatbot-input input { flex: 1; padding: 0.7rem; border: none; font-size: 1rem; }
    .chatbot-input button { background: #2563eb; color: white; border: none; padding: 0 1rem; cursor: pointer; }
</style>
</head>
<body>

<header>
    <h1>Court AI Legal Assistant</h1>
    <p>A legal reasoning simulator ‚Äî advisory only, not legal advice</p>
</header>

<div class="container">

    <!-- Case Intake -->
    <div class="card">
        <h2>Case Intake</h2>
        <p>Describe your dispute in plain language:</p>
        <textarea id="caseFacts" placeholder="My neighbour occupied my house while I was away..."></textarea>
        <select id="caseType">
            <option value="Tenancy">Tenancy Dispute</option>
            <option value="Contract">Contract Dispute</option>
            <option value="Consumer">Consumer Complaint</option>
            <option value="Other">Other</option>
        </select>
        <button onclick="analyzeCase()">Analyze Case</button>
    </div>

    <!-- AI Output -->
    <div class="card output" id="aiOutput" style="display:none;">
        <h2>AI Advisory Output</h2>
        <div id="plaintiffOutput"></div>
        <div id="defendantOutput"></div>
        <div id="leaningOutput"></div>
        <div id="weakPointsOutput"></div>
        <div id="confidenceOutput"></div>
        <button onclick="exportPDF()">Export Court-Style PDF</button>
    </div>

    <!-- Why We Built This -->
    <div class="card">
        <div class="collapsible">Why We Built This ‚¨áÔ∏è</div>
        <div class="content">
            <p>In India and many common law nations, hearings take months or even years to resolve. Litigants spend huge sums on lawyers and court fees. This tool helps users understand how judges reason, where cases succeed, and procedural gaps ‚Äî all advisory and non-binding.</p>
            <p>Example statistics: The average civil case duration in India is ~3.5 years (National Judicial Data Grid 2025).</p>
        </div>
    </div>

    <!-- Laws by Jurisdiction -->
    <div class="card laws-section">
        <h2>Applicable Laws Library</h2>

        <h3>üáÆüá≥ India ‚Äî Core Statutes</h3>
        <a href="https://www.google.com/search?q=Constitution+of+India" target="_blank">Constitution of India</a>
        <a href="https://www.google.com/search?q=Indian+Penal+Code+1860" target="_blank">Indian Penal Code, 1860</a>
        <a href="https://www.google.com/search?q=Code+of+Civil+Procedure+1908" target="_blank">Code of Civil Procedure, 1908</a>
        <a href="https://www.google.com/search?q=Transfer+of+Property+Act+1882" target="_blank">Transfer of Property Act, 1882</a>

        <h3>üá∫üá∏ United States ‚Äî Federal Framework</h3>
        <a href="https://www.google.com/search?q=US+Constitution" target="_blank">U.S. Constitution</a>
        <a href="https://www.google.com/search?q=United+States+Code" target="_blank">United States Code (USC)</a>
        <a href="https://www.google.com/search?q=Federal+Rules+of+Civil+Procedure" target="_blank">Federal Rules of Civil Procedure</a>

        <h3>üá¨üáß United Kingdom ‚Äî Parliamentary Acts</h3>
        <a href="https://www.google.com/search?q=Law+of+Property+Act+1925+UK" target="_blank">Law of Property Act 1925</a>
        <a href="https://www.google.com/search?q=Housing+Act+1988+UK" target="_blank">Housing Act 1988</a>
        <a href="https://www.google.com/search?q=Consumer+Rights+Act+2015+UK" target="_blank">Consumer Rights Act 2015</a>
    </div>

</div>

<!-- Chatbot Icon -->
<div class="chatbot-icon" onclick="toggleChatbot()">üí¨</div>
<div class="chatbot-window" id="chatbotWindow">
    <div class="chatbot-header">Legal Chatbot</div>
    <div class="chatbot-messages" id="chatbotMessages"></div>
    <div class="chatbot-input">
        <input type="text" id="chatbotInput" placeholder="Ask a legal question...">
        <button onclick="sendChat()">Send</button>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const collapsibles = document.querySelectorAll(".collapsible");
collapsibles.forEach(c => {
    c.addEventListener("click", () => {
        const content = c.nextElementSibling;
        content.style.display = content.style.display === "block" ? "none" : "block";
    });
});

function analyzeCase() {
    const facts = document.getElementById("caseFacts").value;
    const caseType = document.getElementById("caseType").value;
    const aiOutput = document.getElementById("aiOutput");

    // Show placeholder while loading
    aiOutput.style.display = "block";
    document.getElementById("plaintiffOutput").innerHTML = "Loading...";
    document.getElementById("defendantOutput").innerHTML = "";
    document.getElementById("leaningOutput").innerHTML = "";
    document.getElementById("weakPointsOutput").innerHTML = "";
    document.getElementById("confidenceOutput").innerHTML = "";

    fetch("/api/analyze", {
        method: "POST",
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ facts, caseType })
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById("plaintiffOutput").innerHTML = `<span class="badge plaintiff">Plaintiff:</span> ${data.plaintiff.join(", ")}`;
        document.getElementById("defendantOutput").innerHTML = `<span class="badge defendant">Defendant:</span> ${data.defendant.join(", ")}`;
        document.getElementById("leaningOutput").innerHTML = `<span class="badge leaning">Likely Court Leaning:</span> ${data.leaning}`;
        document.getElementById("weakPointsOutput").innerHTML = `<span class="badge weak-point">Weak Points:</span> Plaintiff: ${data.weakPoints.plaintiff}, Defendant: ${data.weakPoints.defendant}`;
        document.getElementById("confidenceOutput").innerHTML = `<span class="badge">Confidence Score:</span> 85% (example)`;
    });
}

function toggleChatbot() {
    const win = document.getElementById("chatbotWindow");
    win.style.display = win.style.display === "flex" ? "none" : "flex";
}

function sendChat() {
    const input = document.getElementById("chatbotInput");
    const message = input.value;
    if (!message) return;
    const messagesDiv = document.getElementById("chatbotMessages");
    messagesDiv.innerHTML += `<div><b>You:</b> ${message}</div>`;
    input.value = "";

    fetch("/api/chat", {
        method: "POST",
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message })
    })
    .then(res => res.json())
    .then(data => {
        messagesDiv.innerHTML += `<div><b>AI:</b> ${data.reply}</div>`;
        messagesDiv.scrollTop = messagesDiv.scrollHeight;
    });
}

function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const facts = document.getElementById("caseFacts").value;
    doc.setFontSize(16);
    doc.text("Court AI - Advisory Judgment", 10, 10);
    doc.setFontSize(12);
    doc.text(`Case Facts:\n${facts}`, 10, 20);
    const plaintiff = document.getElementById("plaintiffOutput").innerText;
    const defendant = document.getElementById("defendantOutput").innerText;
    doc.text(plaintiff, 10, 50);
    doc.text(defendant, 10, 60);
    doc.save("court_ai_judgment.pdf");
}
</script>

</body>
</html>
